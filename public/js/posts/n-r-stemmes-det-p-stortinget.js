// hello

(function () {
    var voteCounts  = {"1254866400":1,"1255298400":5,"1256076000":1,"1256162400":9,"1257375600":1,"1257807600":2,"1258412400":8,"1258585200":5,"1259190000":54,"1259276400":3,"1259794800":19,"1259881200":2,"1260140400":13,"1260226800":48,"1260313200":28,"1260399600":22,"1260486000":20,"1260745200":18,"1260831600":34,"1261004400":13,"1262818800":2,"1263250800":8,"1263423600":1,"1265065200":1,"1265238000":6,"1265670000":1,"1265842800":12,"1266274800":3,"1266447600":7,"1267484400":20,"1267657200":15,"1267743600":20,"1268089200":31,"1268262000":14,"1268866800":7,"1268953200":18,"1269212400":14,"1269298800":14,"1269471600":17,"1269558000":3,"1271628000":12,"1271714400":12,"1272319200":9,"1272492000":9,"1272837600":2,"1272924000":7,"1273096800":6,"1273442400":19,"1273528800":17,"1274738400":27,"1274824800":1,"1274911200":19,"1275256800":2,"1275429600":5,"1275516000":7,"1275602400":4,"1275861600":17,"1275948000":25,"1276034400":9,"1276120800":34,"1276207200":13,"1276466400":51,"1276552800":44,"1276639200":15,"1276725600":30,"1276812000":31,"1286229600":8,"1286748000":1,"1286834400":3,"1286920800":2,"1288216800":11,"1288303200":10,"1289430000":18,"1289516400":4,"1289862000":18,"1290034800":11,"1290121200":12,"1290466800":20,"1290726000":46,"1291071600":14,"1291244400":11,"1291330800":9,"1291590000":24,"1291676400":21,"1291762800":28,"1291849200":30,"1291935600":18,"1292194800":54,"1292281200":17,"1292367600":32,"1292454000":26,"1292540400":16,"1294700400":9,"1295218800":1,"1296514800":4,"1296687600":2,"1297119600":6,"1297292400":17,"1297724400":7,"1297897200":3,"1298329200":27,"1298502000":18,"1299711600":18,"1299798000":2,"1300057200":10,"1300143600":22,"1300662000":12,"1300748400":5,"1301263200":6,"1301349600":12,"1301868000":8,"1301954400":41,"1302472800":17,"1302559200":24,"1302732000":43,"1303768800":17,"1303941600":2,"1304287200":19,"1304373600":5,"1304546400":5,"1304892000":1,"1304978400":1,"1305756000":13,"1306101600":17,"1306188000":13,"1306360800":9,"1306447200":9,"1306706400":6,"1306792800":17,"1307311200":27,"1307397600":27,"1307484000":19,"1307570400":29,"1307656800":11,"1308002400":59,"1308088800":27,"1308261600":85,"1317765600":7,"1318284000":1,"1318370400":1,"1319666400":2,"1320879600":24,"1320966000":5,"1321311600":5,"1321484400":3,"1321570800":8,"1321916400":8,"1322175600":43,"1322434800":9,"1322521200":8,"1322694000":23,"1322780400":4,"1323039600":21,"1323126000":24,"1323212400":16,"1323298800":18,"1323385200":10,"1323644400":33,"1323730800":23,"1323817200":25,"1323903600":28,"1323990000":15,"1324249200":9,"1324335600":13,"1326063600":10,"1326150000":3,"1326322800":4,"1326927600":2,"1327964400":8,"1328569200":18,"1328742000":3,"1329346800":5,"1330383600":2,"1330556400":46,"1330988400":2,"1331161200":9,"1332111600":27,"1332198000":18,"1332370800":15,"1332712800":8,"1332799200":5,"1332972000":16,"1334181600":14,"1334527200":2,"1334613600":2,"1335218400":1,"1335391200":2,"1335996000":19,"1336341600":10,"1336428000":4,"1336600800":19,"1336946400":8,"1337032800":19,"1337551200":16,"1337637600":5,"1337810400":11,"1338242400":18,"1338328800":3,"1338415200":24,"1338760800":26,"1338847200":21,"1338933600":7,"1339020000":36,"1339452000":102,"1339538400":17,"1339624800":42,"1339711200":17,"1349388000":9,"1349733600":7,"1349906400":8,"1350338400":4,"1351116000":11,"1352329200":7,"1352934000":14,"1353366000":19,"1353538800":11,"1354057200":40,"1354143600":28,"1354230000":10,"1354575600":29,"1354662000":23,"1354748400":40,"1354834800":11,"1355094000":42,"1355180400":24,"1355266800":25,"1355353200":28,"1355439600":9,"1355698800":35,"1355785200":26,"1357772400":1,"1358377200":3,"1358809200":12,"1358982000":8,"1360018800":3,"1360191600":10,"1360623600":22,"1360796400":1,"1361228400":25,"1361401200":1,"1362438000":4,"1362610800":9,"1363561200":21,"1363647600":37,"1363820400":34,"1364853600":16,"1365026400":2,"1365458400":2,"1366063200":8,"1366668000":25,"1367186400":20,"1367272800":6,"1367877600":14,"1368482400":19,"1368655200":7,"1369087200":4,"1369605600":36,"1369692000":20,"1369864800":23,"1370210400":16,"1370296800":45,"1370469600":49,"1370556000":21,"1370901600":88,"1370988000":7,"1371074400":67,"1371160800":32,"1371420000":36,"1371506400":54,"1371592800":128,"1371679200":44,"1371765600":13,"1381096800":1,"1382047200":1,"1382479200":5,"1382565600":2,"1384210800":9,"1384815600":3,"1385420400":8,"1385593200":2,"1386025200":8,"1386111600":5,"1386198000":13,"1386284400":5,"1386543600":21,"1386630000":14,"1386716400":6,"1386802800":14,"1386889200":9,"1387148400":11,"1387234800":14,"1387407600":7,"1389654000":5,"1389826800":5,"1391036400":5,"1391468400":2,"1392073200":2,"1392246000":7,"1393282800":15,"1393455600":4,"1393887600":1,"1394060400":4,"1395097200":8,"1395270000":10,"1395702000":6,"1395874800":4,"1396303200":5,"1396476000":9,"1396908000":6,"1397080800":4,"1398290400":5,"1399327200":11,"1399500000":2,"1399932000":41,"1400536800":7,"1400709600":12,"1400796000":2,"1401141600":6,"1401746400":25,"1401919200":13,"1402351200":27,"1402437600":8,"1402524000":25,"1402610400":8,"1402869600":85,"1403042400":60,"1403128800":30,"1403215200":30,"1412632800":3,"1413237600":2,"1413410400":1,"1413842400":1,"1415660400":4,"1415833200":11,"1416265200":9,"1416438000":7,"1416870000":16,"1417474800":50,"1417647600":11,"1417734000":10,"1417993200":46,"1418079600":34,"1418166000":18,"1418252400":23,"1418338800":30,"1418598000":39,"1418684400":27,"1418857200":7,"1421103600":1,"1422486000":4,"1422918000":33,"1423090800":21,"1423522800":3,"1423695600":7};
    var rebelCounts = {"1255298400":2,"1258412400":1,"1259190000":12,"1259794800":7,"1260140400":2,"1260226800":27,"1260313200":10,"1260399600":6,"1260745200":4,"1260831600":2,"1261004400":3,"1265238000":4,"1265842800":12,"1266447600":10,"1267484400":14,"1267743600":7,"1268089200":32,"1268262000":9,"1268866800":4,"1268953200":10,"1269212400":3,"1269298800":23,"1269471600":12,"1271628000":4,"1271714400":22,"1272319200":1,"1272492000":10,"1272924000":10,"1273096800":1,"1273442400":23,"1273528800":19,"1274738400":11,"1274911200":24,"1275516000":2,"1275861600":12,"1275948000":3,"1276034400":2,"1276120800":29,"1276207200":6,"1276466400":17,"1276552800":32,"1276639200":7,"1276725600":11,"1276812000":14,"1286229600":4,"1288216800":12,"1288303200":5,"1289430000":15,"1289516400":6,"1290034800":1,"1290121200":5,"1290466800":8,"1290726000":5,"1291071600":5,"1291244400":10,"1291330800":1,"1291590000":4,"1291676400":5,"1291762800":9,"1291849200":7,"1291935600":3,"1292194800":19,"1292281200":5,"1292367600":5,"1292454000":8,"1292540400":8,"1296514800":8,"1297119600":2,"1297292400":12,"1297724400":2,"1298329200":6,"1298502000":10,"1299711600":21,"1300057200":6,"1300143600":8,"1300662000":1,"1300748400":3,"1301263200":1,"1301868000":29,"1301954400":14,"1302472800":9,"1302559200":20,"1302732000":28,"1303768800":16,"1304287200":7,"1305756000":5,"1306101600":7,"1306360800":1,"1306706400":2,"1306792800":13,"1307311200":6,"1307397600":8,"1307484000":20,"1307570400":12,"1308002400":24,"1308088800":12,"1308261600":35,"1320879600":4,"1320966000":2,"1321570800":2,"1322175600":12,"1322434800":4,"1322521200":2,"1322694000":9,"1322780400":4,"1323039600":3,"1323126000":4,"1323212400":2,"1323298800":2,"1323385200":2,"1323644400":8,"1323730800":4,"1323817200":6,"1323903600":17,"1323990000":7,"1324249200":1,"1324335600":5,"1326150000":4,"1326322800":1,"1327964400":5,"1328569200":54,"1329346800":6,"1330383600":2,"1330556400":10,"1331161200":3,"1332111600":7,"1332198000":11,"1332370800":9,"1332712800":2,"1332972000":4,"1334181600":3,"1334527200":4,"1335996000":16,"1336341600":12,"1336428000":3,"1336600800":10,"1337032800":11,"1337551200":7,"1337637600":1,"1337810400":4,"1338242400":2,"1338415200":14,"1338760800":27,"1338847200":4,"1339020000":8,"1339452000":30,"1339538400":6,"1339624800":23,"1339711200":3,"1349388000":2,"1349906400":1,"1350338400":2,"1351116000":8,"1352329200":7,"1352934000":2,"1353366000":6,"1353538800":1,"1354057200":3,"1354143600":7,"1354230000":4,"1354575600":4,"1354662000":1,"1354748400":28,"1354834800":5,"1355094000":9,"1355180400":3,"1355266800":6,"1355353200":8,"1355439600":1,"1355698800":16,"1355785200":6,"1358809200":12,"1360191600":2,"1360623600":32,"1361228400":16,"1362610800":5,"1363561200":1,"1363647600":31,"1363820400":17,"1364853600":1,"1365026400":1,"1366063200":6,"1366668000":12,"1367186400":8,"1367272800":2,"1367877600":2,"1368482400":3,"1369087200":2,"1369605600":20,"1369692000":8,"1369864800":4,"1370210400":7,"1370296800":14,"1370469600":14,"1370556000":5,"1370901600":38,"1371074400":20,"1371160800":4,"1371420000":5,"1371506400":15,"1371592800":26,"1371679200":31,"1371765600":5,"1385420400":1,"1386111600":1,"1386198000":3,"1386284400":2,"1386543600":2,"1386630000":3,"1386802800":6,"1386889200":1,"1387407600":4,"1393282800":2,"1393455600":5,"1395097200":1,"1395702000":2,"1397080800":1,"1398290400":3,"1399327200":12,"1399500000":1,"1399932000":30,"1400536800":1,"1400709600":2,"1401141600":3,"1401746400":2,"1401919200":4,"1402351200":4,"1402524000":15,"1402610400":3,"1402869600":11,"1403042400":7,"1403128800":8,"1403215200":2,"1415660400":1,"1415833200":2,"1416265200":1,"1416438000":1,"1416870000":1,"1417474800":10,"1417647600":1,"1417734000":2,"1417993200":25,"1418079600":14,"1418166000":4,"1418252400":7,"1418338800":5,"1418598000":10,"1418684400":5,"1422918000":3,"1423090800":3,"1423695600":1};

    var voteHours  = [["07",0],["08",0],["09",3],["10",119],["11",91],["12",290],["13",384],["14",354],["15",420],["16",464],["17",431],["18",462],["19",428],["20",688],["21",363],["22",376],["23",250],["00",429],["01",151],["02",0],["03",0],["04",0],["05",0],["06",0]];
    var rebelHours = [["07",0],["08",0],["09",0],["10",6],["11",44],["12",117],["13",108],["14",178],["15",138],["16",171],["17",138],["18",147],["19",160],["20",277],["21",223],["22",199],["23",86],["00",83],["01",42],["02",0],["03",0],["04",0],["05",0],["06",0]];

    function heatmap() {
        cal = new CalHeatMap();
        cal.init({
            itemSelector: '#nar-stemmes-det-pa-stortinget-calendar',
            domain: 'year',
            subDomain: 'day',
            start: new Date(2009, 0, 1),
            minDate: new Date(2009, 0, 1),
            maxDate: new Date(2014, 11, 1),
            data: voteCounts,
            range: 6,
            verticalOrientation: true,
            tooltip: true,
            label: { position: 'top' },
            colLimit: 52,
            subDomainDateFormat: function (date) { return moment(date).format('ll'); },
            itemName: ['avstemning', 'avstemninger'],
            subDomainTitleFormat: {filled: '{date}: {count} {name}'}
        });

        var select = d3.select('#nar-stemmes-det-pa-stortinget-calendar-select');
        select.on('change', function () {
            if (d3.event.target.value === 'Avstemninger') {
                cal.options.itemName = ['avstemning', 'avstemninger'];
                cal.update(voteCounts);
            } else {
                cal.options.itemName = ['utbryterstemme', 'utbryterstemmer'];
                cal.update(rebelCounts);
            }
        });
    }

    function scatter() {
        var chart = c3.generate({
            bindto: '#nar-stemmes-det-pa-stortinget-scatter',
            data: {
                xs: {
                    Avstemninger: 'Utbryterstemmer'
                },
                columns: [
                    ['Avstemninger', 2,1,7,3,1,25,9,5,3,2,2,2,8,5,6,7,6,5,1,8,2,7,10,4,5,1,4,7,1,5,10,6,12,2,10,3,2,18,3,8,13,4,9,9,3,5,5,3,2,1,3,4,4,3,7,1,3,4,5,6,3,9,3,4,6,5,2,2,4,1,3,7,7,5,4,1,3,1,6,9,4,7,16,8,7,3,6,1,2,5,3,6,9,8,13,10,10,11,3,2,1,7,3,2,6,2,2,4,1,2,2,6,4,3,7,5,1,5,2,1,5,5,3,2,9,2,3,8,6,2,2,2,1,9,4,2,7,6,5,1,3,2,9,10,3,7,6,12,6,12,3,2,1,2,5,3,2,6,1,3,5,3,4,1,14,3,7,3,4,5,1,7,4,9,2,11,10,2,1,8,12,1,1,4,7,4,1,2,1,2,15,6,3,5,13,12,2,25,12,4,17,10,13,17,4,1,1,3,1,1,2,2,1,2,1,2,1,1,1,1,5,1,17,1,2,2,2,3,4,6,2,9,1,4,5,2,1,2,1,1,1,2,6,1,2,9,9,2,5,4],
                    ['Utbryterstemmer', 2,1,12,7,2,27,10,6,4,2,3,4,12,10,14,7,32,9,4,10,3,23,12,4,22,1,10,10,1,23,19,11,24,2,12,3,2,29,6,17,32,7,11,14,4,12,5,15,6,1,5,8,5,5,10,1,4,5,9,7,3,19,5,5,8,8,8,2,12,2,6,10,21,6,8,1,3,1,29,14,9,20,28,16,7,5,7,1,2,13,6,8,20,12,24,12,14,21,4,2,2,12,4,2,9,4,3,4,2,2,2,8,4,6,17,7,1,5,4,1,5,54,6,2,10,3,7,11,9,2,4,3,4,16,12,3,10,11,7,1,4,2,14,27,4,8,13,17,6,23,3,2,1,2,8,7,2,6,1,3,7,4,4,1,28,5,9,3,6,8,1,16,6,12,2,32,16,5,1,31,17,1,1,6,12,8,2,2,3,2,20,8,4,7,14,14,5,38,20,4,20,12,14,31,5,1,1,3,2,2,3,6,1,4,2,5,1,2,1,3,12,1,30,1,2,3,2,4,4,15,3,11,1,6,8,2,1,2,1,1,1,2,8,1,2,25,14,4,7,5]
                ],
                type: 'scatter'
            },
            axis: {
                x: {
                    label: 'Utbryterstemmer',
                    tick: {
                        fit: false
                    }
                },
                y: {
                    label: 'Avstemninger'
                }
            },
            legend: { show: false },
            tooltip: {
                format: {
                    title: function (d) { return 'Utbryterstemmer: ' + d; },
                    value: function (value, ratio, id) { return value; }
                }
            }
        });
    }

    function hourHistogram(selector, title, data) {
        var chart = c3.generate({
            bindto: selector,
            data: {
                x: 'Time på døgnet',
                columns: [
                    ['Time på døgnet'].concat(data.map(function (e) { return e[0]; })),
                    [title].concat(data.map(function (e) { return e[1]; }))

                ],
                type: 'bar'

            },
            transition: { duration: 0 },
            axis: {
                x: { type: 'category' }
            }
        });
    }

    function dayCounts() {
        var days = [["2009-2010", 67], ["2010-2011", 72], ["2011-2012", 71], ["2012-2013", 65], ["2013-2014", 57]];
        var votes = [["2009-2010", 947], ["2010-2011", 1196], ["2011-2012", 1032], ["2012-2013", 1453], ["2013-2014", 657]];

        var chart = c3.generate({
            bindto: '#nar-stemmes-det-pa-stortinget-day-counts',
            data: {
                x: 'Stortingssesjon',
                columns: [
                    ['Stortingssesjon'].concat(days.map(function (e) { return e[0]; })),
                    ['Antall dager med avstemninger'].concat(days.map(function (e) { return e[1]; })),
                    ['Antall avstemninger'].concat(votes.map(function (e) { return e[1]; }))
                ],
                type: 'spline',
                axes: {
                    'Antall dager med avstemninger': 'y',
                    'Antall avstemninger': 'y2'
                }

            },
            axis: {
                rotated: false,
                x: { type: 'category' },
                y: { min: 0 },
                y2: { show: true, min: 0 }
            },
            transition: { duration: 0 },
            point: { show: false}
        });
    }

    heatmap('votes');
    dayCounts();
    hourHistogram('#nar-stemmes-det-pa-stortinget-hours', 'Antall avstemninger', voteHours);
    hourHistogram('#nar-stemmes-det-pa-stortinget-rebel-hours', 'Antall utbryterstemmer', rebelHours);
    rebelHours();
    scatter();

}());

